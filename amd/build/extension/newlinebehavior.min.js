define("tiny_ibwidgethub/extension/newlinebehavior",["exports"],(function(_exports){
/**
   * Tiny WidgetHub plugin.
   *
   * @module      tiny_ibwidgethub/plugin
   * @copyright   2024 Josep Mulet Pol <pep.mulet@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
function removeEmptyParagraphs(content){if(!content)return"";if(!/<(script|pre|code)[\s>]/i.test(content))return content.replace(/<p>\s*<\/p>/gi,"");try{const doc=(new DOMParser).parseFromString(content,"text/html");return doc.querySelectorAll("p").forEach((p=>{/^\s*$/.test(p.innerHTML)&&!p.closest("pre, code, script")&&p.remove()})),doc.body.innerHTML}catch(err){return content.replace(/<p>\s*<\/p>/gi,"")}}function padEmptyParagraphsWith(content){let padWith=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"<br>";if(!content)return"";if(!/[<](script|pre|code|!--)/i.test(content))return content.replace(/<p>\s*<\/p>/gi,`<p>${padWith}</p>`);try{const doc=(new DOMParser).parseFromString(content,"text/html");return doc.querySelectorAll("p").forEach((p=>{if(p.closest("pre, code, script"))return;if(Array.from(p.childNodes).every((node=>{return node.nodeType===Node.COMMENT_NODE||node.nodeType===Node.TEXT_NODE&&!(null!==(_node$textContent=node.textContent)&&void 0!==_node$textContent&&_node$textContent.trim());var _node$textContent}))){const comments=Array.from(p.childNodes).filter((n=>n.nodeType===Node.COMMENT_NODE)).map((n=>n.nodeType===Node.COMMENT_NODE?`\x3c!--${n.data}--\x3e`:"")).join("");p.innerHTML=`${padWith}${comments}`}})),doc.body.innerHTML}catch(err){return content.replace(/<p>\s*<\/p>/gi,`<p>${padWith}</p>`)}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.emulateAttoNewlineBehaviour=function(editor){editor._orgSetContent||(editor._orgSetContent=editor.setContent,editor.setContent=function(content,args){let processedContent=content;try{args&&"html"!==args.format||(processedContent=removeEmptyParagraphs(content))}catch(err){console.warn("setContent patch failed",err)}return editor._orgSetContent.call(this,processedContent,args)});editor._orgGetContent||(editor._orgGetContent=editor.getContent,editor.getContent=function(args){let content=editor._orgGetContent.call(this,args)||"";try{content=padEmptyParagraphsWith(content)}catch(err){console.warn("getContent patch failed",err)}return content})},_exports.padEmptyParagraphsWith=padEmptyParagraphsWith,_exports.removeEmptyParagraphs=removeEmptyParagraphs}));

//# sourceMappingURL=newlinebehavior.min.js.map